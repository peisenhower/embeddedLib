/*******************************************************************************
* Includes
*******************************************************************************/
#include "print.h"
#include <stdio.h>
#include <stdint.h>

/*******************************************************************************
* Defines
*******************************************************************************/
#define STACK_BUFFER_SIZE 128

/*******************************************************************************
* Local Types and Typedefs
*******************************************************************************/

/*******************************************************************************
* Global Variables
*******************************************************************************/

/*******************************************************************************
* Static Function Prototypes
*******************************************************************************/
static print_fn_t printFn = NULL;

/*******************************************************************************
* Static Variables
*******************************************************************************/

/*******************************************************************************
* Functions
*******************************************************************************/


int el_printInit(print_fn_t printFunction)
{
    if (printFunction == NULL)
        return -1;

    printFn = printFunction;
    return 0;
}

int el_print(const void *format, ...)
{
    if (printFn == NULL)
        return -1;

    int status;
    va_list args;
    va_start(args, format);

    char buffer[STACK_BUFFER_SIZE];

    vsnprintf(buffer, STACK_BUFFER_SIZE, format, args);
    status = printFn(buffer, strlen(buffer));

    va_end(args);

    return status;
}

